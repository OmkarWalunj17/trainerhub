<div class="page-container">
    <div class="bg-shape shape-1"></div>
    <div class="bg-shape shape-2"></div>
    <div class="bg-grid"></div>

    <div class="content-card">
        <div class="card-header">
            <div class="logo-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
                    <circle cx="9" cy="7" r="4" />
                    <path d="M22 21v-2a4 4 0 0 0-3-3.87" />
                    <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                </svg>
            </div>
            <h2 class="title">Trainer Directory</h2>
            <p class="subtitle">Manage, monitor, and recruit top-tier trainers.</p>
        </div>

        <div class="controls-row">
            <div class="form-group search-group">
                <label for="searchInput">Search</label>
                <div class="input-wrapper">
                    <span class="input-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8" />
                            <line x1="21" y1="21" x2="16.65" y2="16.65" />
                        </svg>
                    </span>

                    <input id="searchInput" type="text" placeholder="Search by name or expertise..."
                        [(ngModel)]="searchText" (input)="searchTrainers()" [disabled]="loadingTrainers" />
                </div>
            </div>

            <div class="form-group filter-group">
                <label for="statusFilter">Filter by Status</label>
                <div class="select-wrapper">
                    <select id="statusFilter" [(ngModel)]="searchStatusText" (change)="searchByStatus()"
                        [disabled]="loadingTrainers">
                        <option value="">All Statuses</option>
                        <option value="Active">Active</option>
                        <option value="Inactive">Inactive</option>
                    </select>

                    <span class="select-arrow">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m6 9 6 6 6-6" />
                        </svg>
                    </span>
                </div>
            </div>
        </div>

        <div *ngIf="loadingTrainers" class="loading-state">
            <div class="spinner"></div>
            <span>Loading trainers...</span>
        </div>

        <div class="table-wrapper" *ngIf="!loadingTrainers">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Profile</th>
                        <th>Expertise</th>
                        <th>Experience</th>
                        <th>Certification</th>
                        <th>Joined</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>

                <tbody>
                    <tr *ngFor="let t of pagedTrainer">
                        <td>
                            <div class="profile-cell">
                                <div class="profile-avatar">{{ t.name.charAt(0).toUpperCase() }}</div>
                                <div class="profile-info">
                                    <div class="profile-name">{{ t.name }}</div>
                                    <div class="profile-meta">{{ t.email }}</div>
                                </div>
                            </div>
                        </td>

                        <td class="bold-cell">{{ t.expertise }}</td>
                        <td>{{ t.experience }}</td>
                        <td>{{ t.certification }}</td>
                        <td>{{ t.joiningDate }}</td>

                        <td>
                            <span class="status-badge" [class.status-active]="t.status === 'Active'"
                                [class.status-inactive]="t.status !== 'Active'">
                                {{ t.status }}
                            </span>
                        </td>

                        <td class="actions-cell">
                            <button class="btn-action btn-edit" (click)="updateTrainer(t)" title="Edit">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
                                </svg>
                            </button>

                            <button class="btn-action btn-toggle" (click)="toggleStatus(t)"
                                [title]="t.status === 'Active' ? 'Deactivate' : 'Activate'">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M18.36 6.64a9 9 0 1 1-12.73 0" />
                                    <line x1="12" y1="2" x2="12" y2="12" />
                                </svg>
                            </button>

                            <button class="btn-action btn-resume" (click)="viewResume(t)" [disabled]="isOpeningResume"
                                title="View Resume">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                                    <polyline points="14 2 14 8 20 8" />
                                    <line x1="16" y1="13" x2="8" y2="13" />
                                    <line x1="16" y1="17" x2="8" y2="17" />
                                    <polyline points="10 9 9 9 8 9" />
                                </svg>
                            </button>

                            <button class="btn-action btn-delete" (click)="requestDelete(t)" title="Delete">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <polyline points="3 6 5 6 21 6" />
                                    <path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6" />
                                    <path d="M10 11v6" />
                                    <path d="M14 11v6" />
                                    <path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2" />
                                </svg>
                            </button>
                        </td>
                    </tr>

                    <tr *ngIf="filteredTrainers.length === 0">
                        <td colspan="7" class="empty-state">
                            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24"
                                fill="none" stroke="#9ca3af" stroke-width="1.5" stroke-linecap="round"
                                stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10" />
                                <line x1="12" y1="8" x2="12" y2="12" />
                                <line x1="12" y1="16" x2="12.01" y2="16" />
                            </svg>
                            <p>No trainers found. Try adjusting filters.</p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="pagination-bar" *ngIf="!loadingTrainers && filteredTrainers.length > 0">
            <div class="pager">
                <button (click)="prevPage()" [disabled]="currentPage === 1">Prev</button>

                <span class="page-info">
                    Page {{ currentPage }} of {{ totalPages }}
                </span>

                <button (click)="nextPage()" [disabled]="currentPage === totalPages">Next</button>
            </div>
        </div>

    </div>
</div>

<app-confirm-modal [isVisible]="showConfirmModal" [message]="confirmMessage" [confirmLabel]="'Yes, Delete'"
    [cancelLabel]="'Cancel'" (onConfirm)="onConfirmDelete()" (onCancel)="onCancelDelete()">
</app-confirm-modal>

<app-success-modal [isVisible]="showSuccessModal" [message]="successMessage" (onClose)="onSuccessClose()">
</app-success-modal>

<app-failure-modal [isVisible]="showFailureModal" [message]="failureMessage" [buttonText]="'Okay'"
    (onClose)="onFailureClose()">
</app-failure-modal>